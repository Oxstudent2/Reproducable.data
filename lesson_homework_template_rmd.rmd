---
title: "Homework Template"
output:
  html_document: default
  pdf_document: default
date: "2023-10-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*The following is a template .rmd RMarkdown file for you to use for your homework submission.*

*Please Knit your .rmd to a PDF format or HTML and submit that with no identifiers like your name.*

*To create a PDF, first install tinytex and load the package. Then press the Knit arrow and select "Knit to PDF".*

## QUESTION 01: Data Visualisation for Science Communication

*Create a figure using the Palmer Penguin dataset that is correct but badly communicates the data. **Do not make a boxplot**.*

*Use the following references to guide you:*

-   [*https://www.nature.com/articles/533452a*](https://www.nature.com/articles/533452a){.uri}
-   [*https://elifesciences.org/articles/16800*](https://elifesciences.org/articles/16800){.uri}

*Note: Focus on visual elements rather than writing misleading text on it.*

### a) Provide your figure here:

```{r bad figure code, echo=FALSE,  message=FALSE, warning=FALSE, results='hide'}
options(repos = list(CRAN="http://cran.rstudio.com/"))
install.packages("palmerpenguins")
install.packages('dplyr')
install.packages('ggplot2')
library(dplyr)
library(palmerpenguins)
library(ggplot2)

source("NewFunctions/CleaningPenguins.R")
penguins_clean <- penguins_raw %>%
  clean_function%>%
    clean_column_names()%>%
  shorten_species ()

head(penguins_clean)
penguinscleaner<-remove_NA(penguins_clean)
head(penguinscleaner)

ggplot(penguinscleaner, aes(x = culmen_length_mm,
                           y = culmen_depth_mm))+
   xlim(30, 70)+
  ylim(0, 50)+
  geom_line(colour = 'springgreen2',
            lwd=1.5)+
  geom_smooth(method = 'lm', colour = 'chartreuse1', lwd = 3)+
  theme(panel.background = element_rect(fill = "green"))+
  labs(x = 'culmen length (mm)',
       y = 'culmen depth (mm)',
       title = 'culmen depth relative to culmen length')
```

### b) Write about how your design choices mislead the reader about the underlying data (200-300 words).

Firstly, I created a line plot instead of a scatter graph for this data as it creates a lot of unnecessary noise on the plot in the form of lines that connect points. Furthermore, I increased the width of the lines so some of the points overlap and are swallowed up by the line so cannot be seen accurately. 
I also made the axis much bigger than necessary â€“ this had several effects. Firstly, it makes the data more compact and minimizes any patterns or trends that could be previously seen in the data, for example, when the graph is in a relevant fitted axis, the linear correlation seen on the line of best fit is much more prominent, however as I have spread the axis lines out so much, it looks like there is almost no trend. Squashing the y axis especially makes the data look much less varied than it actually is, and makes it seem that culmen depth does not vary much. 
I did not colour individual species, therefore it is hard to distinguish species specific trends from this graph and it collates all the species together, which may create misleading results. The colours make it hard to distinguish the plot form the background, making it hard to distinguish even for those who are not colour blind. The colours on the graph are not colour blind friendly, so individuals may have a hard time detecting the actually graph, and I made the line of best fit so thick it obscures some of the data points, further confusing and construing  the data.

------------------------------------------------------------------------

## QUESTION 2: Data Pipeline

*Write a data analysis pipeline in your .rmd RMarkdown file. You should be aiming to write a clear explanation of the steps as well as clear code.*

*Your code should include the steps practiced in the lab session:*

-   *Load the data*

-   *Appropriately clean the data*

-   *Create an Exploratory Figure (**not a boxplot**)*

-   *Save the figure*

-   ***New**: Run a statistical test*

-   ***New**: Create a Results Figure*

-   *Save the figure*

*An exploratory figure shows raw data, such as the distribution of the data. A results figure demonstrates the stats method chosen, and includes the results of the stats test.*

*Between your code, communicate clearly what you are doing and why.*

*Your text should include:*

-   *Introduction*

-   *Hypothesis*

-   *Stats Method*

-   *Results*

-   *Discussion*

-   *Conclusion*

*You will be marked on the following:*

### a) Your code for readability and functionality

### b) Your figures for communication

### c) Your text communication of your analysis

*Below is a template you can use.*

------------------------------------------------------------------------

### Introduction

```{r Data Exploration,message=FALSE, warning=FALSE, results='hide'}
options(repos = list(CRAN="http://cran.rstudio.com/"))
install.packages("ggplot2")
install.packages("palmerpenguins")
install.packages("janitor")
install.packages("dplyr")
install.packages("ggpubr")
install.packages("tinytex")
install.packages('ragg')
install.packages("svglite")

library(ggplot2)
library(palmerpenguins)
library(janitor)
library(dplyr)
library(ggpubr)
library(ragg)
library(svglite)
```

In this asisgnment I am testing if there is a significant positive corrleation between the body mass of penguins and their flipper length, both within individual species and for the whole palmer group as a whole

below I am loading and cleaning the data before starting

```{r, comment=NA, warning=FALSE}

write.csv(penguins_raw, "data/penguins_raw.csv")
penguins_data <- read.csv("data/penguins_raw.csv")

```


```{r}
source("NewFunctions/CleaningPenguins.R")
penguins_clean <- penguins_raw %>%
  clean_function%>%
    clean_column_names()%>%
  shorten_species ()

  
   
penguins_clean 
```

### Hypothesis

Below I am creating small data sets for each of the species for individual comparisons later

```{r}
AdelieOnly <- FilterAdeli(penguins_clean)
GentooOnly <- FilterGentoo(penguins_clean)
ChinstrapOnly <- FilterChinstrap(penguins_clean)
```

This is the code for the exploratory figure, CompFigAll being the comparison graph that shows all species on one graph, and CompFig being the comparison graph for each species seperately

```{r, warning=FALSE, message=FALSE, comment=NA, results='hide'}
source("PlottingAssignment/AssignmentPlotting.R")
CompFig <- plot_comp_data(penguins_clean)
CompFigAll <- plot_comp_data_all(penguins_clean)
  
save_penguin_plot_png(CompFig)
save_penguin_plot_svg(CompFig)
save_penguin2_plot_png(CompFigAll)
save_penguin2_plot_svg(CompFigAll)

CompFig
CompFigAll
```

Based on the exploratory figures, we can see the general trend that an increase in body mass leads to an increase in flipper length, and that males tend to be larger than females within species.  

 Based on this I could use a correlation test to see if these visual trends are valid by performing a correlation test, to see if there is a significant positive correlation. 
     I hypothesise That there will be a significant positive correlation between body mass and flipper length both within individual species and across the entire data set as a whole, as the lines seen in the exploratory figure are relativly steep and positive  

before I run any statistical tests, I am going to check the data is normally distrobuted for each species by checing some histograms for the distrobution of body size across the penguins

This is so I can determine what statistical tests I will need to run and if i need to make any changes to the data before running statistical tests

```{r, message=FALSE, warning=FALSE}
source("PlottingAssignment/AssignmentPlotting.R")
normal_plot_check(penguins_clean)
```

These histograms are normally distrobuted, so I wont be making any adjustments to the data or performing a special test for non normally distrobuted data

### Statistical Methods

I am going to run a correlation test and create a figure featuring the results of the corrleation test on the species and the overall penguins.  
      I am using a correlation test becuase I am trying to determine if there is a correlation between these 2 variables, and the correlation coefficient will determine the strength of the relationship, and if this relationship is significant.  
      Hence the correlation coeficcient will allow me to detemrine if the observed correlations in the exploratory figure are significnat, and that there is a positive relationsbhip between body mass and flipper length
      
   Here I am creating figures and saving them in the assigmnet figures file to observe later and also seen in the Rmd file
    
```{r, warning=FALSE, comment=NA, results='hide'}
source("NewFunctions/AssignmentStatsFunctions.R")
GentooFigure <- GentooCorFig(GentooOnly)
AdelieFigure <- AdelieCorFig(AdelieOnly)
ChinstrapFigure<- ChinstrapCorFig(ChinstrapOnly)
AllSpeciesFigure <- PenguinsCorFig(penguins_clean)


save_gentoo_plot_png(GentooFigure)%>%
  save_gentoo_plot_svg(GentooFigure)%>%
save_adelie_plot_png(AdelieFigure)%>%
  save_adelie_plot_svg(AdelieFigure)%>%
save_chinstrap_plot_png(ChinstrapFigure)%>%
save_chinstrap_plot_svg(ChinstrapFigure)

save_all_species_plot_png(AllSpeciesPlot)
    save_all_species_plot_svg(AllSpeciesPlot)
    
```

# Correlation test results for Adelie penguins
```{r, warning=FALSE,comment=NA, message=FALSE}
source("NewFunctions/AssignmentStatsFunctions.R")
  AdelieCorFig(AdelieOnly)%>%
save_adelie_plot_png( AdelieFig)%>%
  save_adelie_plot_svg( AdelieFig)
  

  AdelieCorTest(AdelieOnly)
```

# Correlation test for chinstrap penguins
```{r,warning=FALSE, comment=NA, message=FALSE}
source("NewFunctions/AssignmentStatsFunctions.R")
   ChinstrapCorFig(ChinstrapOnly)%>%
   save_chinstrap_plot_png(ChinstrapFigure)%>%
  save_chinstrap_plot_svg(ChinstrapFigure)
   
ChinstrapCorTest(ChinstrapOnly)
```

# correlation test for gentoo penguins

```{r, warning=FALSE, comment=NA, message=FALSE}
source("NewFunctions/AssignmentStatsFunctions.R")
GentooCorFig(GentooOnly)%>%
save_gentoo_plot_png(GentooFigure)%>%
  save_gentoo_plot_svg(GentooFigure)
 
GentooCorTest(GentooOnly)

```

# Results & Discussion

```{r Plotting Results, warning=FALSE, comment=NA}
GentooFigure
ChinstrapFigure 
 AdelieFigure
```

## Gentoo penguins

The R value is 0.71, demonstrating a strog positive correlation, and this result is significant with 95% certainty as the p value output is 2.2e-16, significantly smaller than the significant P value of 0.005.  
      Therefore we can conclude there is a significant positive correlation between body mass and flipper length
      
## Adelie penguins

The slope of this line is not as postive as the Gentoo line, however the output of the correlation test has an R value of 0.46, which demonstrates a positive correlation but not a super stong one. however, the P value is 3.402e-09, again below 0.05, so we can say with confidence there is a positive correlation between body mass and flipper length in adelie penguins

## Chinstrap penguins

Again Chinstrap penguins show a positive correlation, with an R value of 0.64 indicating a relatively strong positive correlation, and this correlation is significant as the P value is 3.748e-09, again significantly lower than the 0.05 positive correlation value, showing there is a significant positive correlation between body mass and flipper length in Chin strap penguins

## All penguins

The whole data set of the penguins shows a very string significant correlation, with a R coefficient of 0.87, and a p value of 2.2e-16, significantly less than the significant 0.05 value. This reflects the trends for the individual species, that as body mass increases, flipper length increases.\
      If you where looking at just this data set, it would be misleading for the influence of body mass on flipper length between species, as some have much lower positive correlations between species, hence, it has been beneficial to split the up

# Conclusion

As we can see, for all species there is a significant positive correlation between body mass and flipper length, as such as body mass increases, the flipper length also increases.\
      One potential explanation for this is that increased body mass suggests greater body size, and with increased size, all limbs and body appendages would also increase. Non of the relationships are perfectly linear (R=1), however they show significant positive correlations.
      
  furthermore, greater body mass would require greater propulsion, which would be achieved by increasing the surface area and general size of the flipper, so the larger penguin can effectively traverse its environment.
  
  This helps explain the positive significant positive correlation seen across and within species

------------------------------------------------------------------------

## QUESTION 3: Open Science

### a) GitHub

*Upload your RProject you created for **Question 2** and any files and subfolders used to GitHub. Do not include any identifiers such as your name. Make sure your GitHub repo is public.*

*GitHub link:*

*You will be marked on your repo organisation and readability.*

### b) Share your repo with a partner, download, and try to run their data pipeline.

*Partner's GitHub link:*

*You **must** provide this so I can verify there is no plagiarism between you and your partner.*

### c) Reflect on your experience running their code. (300-500 words)

-   *What elements of your partner's code helped you to understand their data pipeline?*

-   *Did it run? Did you need to fix anything?*

-   *What suggestions would you make for improving their code to make it more understandable or reproducible, and why?*

-   *If you needed to alter your partner's figure using their code, do you think that would be easy or difficult, and why?*

### d) Reflect on your own code based on your experience with your partner's code and their review of yours. (300-500 words)

-   *What improvements did they suggest, and do you agree?*

-   *What did you learn about writing code for other people?*
